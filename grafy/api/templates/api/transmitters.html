{% load static %}
{% block content %}

<!DOCTYPE <!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Częstotliwość</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script> developer version vueJs  -->
    <script src="https://cdn.jsdelivr.net/npm/vue"></script>  <!-- production vueJs link  -->
    <script src="https://cdn.jsdelivr.net/npm/vue"></script>  <!-- production vueJs link  -->
    <!--<script src=".\d3.min.js" type="text/javascript" ></script>-->
    <!--bo rzga sie o ścieżkę-->
    <script src="https://d3js.org/d3.v5.min.js"></script>

</head>


<body>
    <div id="TransmittersVue">
        <h1>Nadajniki</h1>
        <p>{{info}}</p>

        <p>Podaj liczbę wszystkich punktów</p>

        <input id="totalPoints" v-on:keyup.enter="getTransmitters" ref="inputTotalPoints" type="text" required>
        <p>Podaj promień miasta</p>
        <input id="cityRadius" v-on:keyup.enter="getTransmitters" ref="inputCityRadius" type="text" required>
        <p>Podaj zasięg nadajnika</p>
        <input id="transmittersWeight" v-on:keyup.enter="getTransmitters" ref="inputTransmittersWeight" type="text" required>
        <button  v-on:click="getTransmitters"> Wyślij </button>
        <ul>
            <li>Lista punktów: [[pointList]]</li>
            <li>Macierz XML: [[matrixXML]]</li>
        </ul>
        [[ errorMessage ]]
      </div>
</body>
</html>

<script>
var TransmittersVue = new Vue({
  el: '#TransmittersVue',
  delimiters: ['[[', ']]'],
  data: {
      totalPoints: '', //liczba punktow
      cityRadius: '', //promien miasta
      transmittersWeight: '', //zasieg nadajnika
      pointList: [],
      matrixXML: 'macierz',
      errorMessage: null,
      statusCode: null,
      backendUrl: window.location.href
  },
  methods:{
      getTransmitters: function(){
          console.log("TUTAJ")
          var TransmittersVue = this;
          TransmittersVue.totalPoints = this.$refs.inputTotalPoints.value
          TransmittersVue.cityRadius = this.$refs.inputCityRadius.value
          TransmittersVue.transmittersWeight = this.$refs.inputTransmittersWeight.value
          if (this.totalPoints != '' &&  this.cityRadius != '' && this.transmittersWeight != ''){
              output = {}
                output.totalPoints = this.totalPoints;
                output.cityRadius = this.cityRadius;
                output.transmittersWeight = this.transmittersWeight;

                axios.post(this.backendUrl, output, {
                            headers: {'Content-Type': 'application/json'}
                }).then(function(response){
                    TransmittersVue.pointList = response.data.pointList;
                    TransmittersVue.matrixXML = response.data.matrixXML;
                    TransmittersVue.drawMatrix()
                    TransmittersVue.errorMessage = response.data.errorMessage //response.data.errorMessage;
                })
                .catch(function(error){
                    TransmittersVue.errorMessage = "Javascript error: " + error;
                });
          }
          else{
            TransmittersVue.errorMessage = "[Błąd] Nie podano wymaganych danych - prosze dopisć";
          }
    },
    drawMatrix: function(){
          //rysowanie macierzy z XML
        // console.log(this.matrixXML)
        parser = new DOMParser();
        xmlDoc = parser.parseFromString(this.matrixXML,"text/xml");
        // document.getElementById("demo").innerHTML =
        console.log("AAAAAAAAAAAAAAAAA")
        var rootElement = xmlDoc.getElementsByTagName("root");


        console.log("A: ", rootElement[0].childNodes)
    }
  }
})
</script>

{% endblock %}